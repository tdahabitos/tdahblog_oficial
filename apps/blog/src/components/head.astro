---
interface Props {
  title?: string;
  description?: string;
  canonical?: string;
  ogImage?: string;
  ogType?: "website" | "article";
  noindex?: boolean;
}

const {
  title = "VivaTDAH",
  description = "ConteÃºdo informativo e acessÃ­vel sobre TDAH",
  canonical,
  ogImage,
  ogType = "website",
  noindex = false,
} = Astro.props as Props;

// âœ… Canonical: prioriza pathname (sem query/hash) + Astro.site quando existir
const canonicalUrl =
  canonical ??
  (Astro.site
    ? new URL(Astro.url.pathname, Astro.site).toString()
    : Astro.url.toString());

const defaultOg = "/og-placeholder.jpg";
const ogPath = ogImage || defaultOg;
const ogUrl =
  /^https?:\/\//i.test(ogPath)
    ? ogPath
    : Astro.site
      ? new URL(ogPath, Astro.site).toString()
      : ogPath;

const robots = noindex ? "noindex,nofollow" : "index,follow";

// âœ… PadrÃ£o â€œNature-likeâ€: motion leve (sem inventar cores)
const motionFast = "120ms";
const motionNormal = "200ms";
const motionEasing = "cubic-bezier(0.4, 0, 0.2, 1)";
---

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>{title}</title>
  <meta name="description" content={description} />

  <link rel="canonical" href={canonicalUrl} />
  <meta name="robots" content={robots} />

  <!-- Open Graph -->
  <meta property="og:site_name" content="VivaTDAH" />
  <meta property="og:locale" content="pt_BR" />
  <meta property="og:type" content={ogType} />
  <meta property="og:url" content={canonicalUrl} />
  <meta property="og:title" content={title} />
  <meta property="og:description" content={description} />
  <meta property="og:image" content={ogUrl} />

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content={title} />
  <meta name="twitter:description" content={description} />
  <meta name="twitter:image" content={ogUrl} />

  <!-- âœ… Base CSS (ordem importa) -->
  <link rel="stylesheet" href="/assets/tdahblog/tokens.css" />
  <link rel="stylesheet" href="/assets/tdahblog/tokens.dark.css" />
  <link rel="stylesheet" href="/assets/tdahblog/global.css" />
  <link rel="stylesheet" href="/assets/tdahblog/prose.css" />

  <!-- âœ… Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
    rel="stylesheet"
  />
  <link
    href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&display=swap"
    rel="stylesheet"
  />

  <style>
    /* âœ… Base: deixa tokens mandarem nas cores */
    html {
      font-family: "Inter", system-ui, -apple-system, sans-serif;
      background: var(--color-surface-0);
      color: var(--color-text-primary);
      text-rendering: geometricPrecision;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      scroll-behavior: smooth;
    }
    body { margin: 0; }

    /* âœ… Motion global leve */
    :root{
      --motion-fast: var(--motion-fast, 120ms);
      --motion-normal: var(--motion-normal, 200ms);
      --motion-easing: var(--motion-easing, cubic-bezier(0.4, 0, 0.2, 1));
    }

    /* âœ… Evita recorte / sobreposiÃ§Ã£o do dropdown */
    header.topbar,
    header.topbar .topbar-inner,
    header.topbar nav.nav,
    header.topbar .dropdown {
      overflow: visible;
    }

    header.topbar .dropdown > .menu {
      position: absolute;
      z-index: 999;
    }

    /* âœ… Hover â€œcalmoâ€ e consistente (sÃ³ para elementos nativos/antigos)
       Nota: o grosso do estilo estÃ¡ no global.css; aqui Ã© sÃ³ safety net. */
    a:hover {
      text-decoration: underline;
      text-underline-offset: 3px;
      text-decoration-thickness: 1px;
    }

    :where(a, button, input, textarea, select, summary, [role="button"]):focus-visible{
      outline: 2px solid var(--focus-ring, var(--color-focus, rgba(246,229,65,.95)));
      outline-offset: 3px;
    }

    /* âœ… iOS: garante tap highlight discreto */
    :where(a, button, .btn) { -webkit-tap-highlight-color: transparent; }
  </style>
</head>
