---
export type SchemaArticleProps = {
  headline: string;
  description?: string;
  image?: string;
  datePublished?: string;
  dateModified?: string;
  authorName?: string;
  url?: string;
};

const {
  headline,
  description,
  image,
  datePublished,
  dateModified,
  authorName,
  url,
} = Astro.props as SchemaArticleProps;

const siteUrl = Astro.site ? Astro.site.toString().replace(/\/$/, "") : "";
const pageUrl = url ?? (Astro.url ? Astro.url.toString() : (siteUrl ? `${siteUrl}/` : ""));
const imageUrl =
  image && siteUrl && image.startsWith("/")
    ? `${siteUrl}${image}`
    : image;

const data = {
  "@context": "https://schema.org",
  "@type": "Article",
  headline,
  ...(description ? { description } : {}),
  ...(imageUrl ? { image: [imageUrl] } : {}),
  ...(datePublished ? { datePublished } : {}),
  ...(dateModified ? { dateModified } : {}),
  ...(authorName ? { author: { "@type": "Person", name: authorName } } : {}),
  ...(pageUrl ? { mainEntityOfPage: pageUrl } : {}),
  ...(siteUrl ? { publisher: { "@type": "Organization", name: "TDAH.blog", url: siteUrl } } : {}),
};
---

<script type="application/ld+json">{JSON.stringify(data)}</script>
