---
export type BreadcrumbItem = { name: string; url: string };

const { items = [] } = Astro.props as { items?: BreadcrumbItem[] };

const siteUrl = Astro.site ? Astro.site.toString().replace(/\/$/, "") : "";
const normalizeUrl = (u: string) =>
  siteUrl && u.startsWith("/") ? `${siteUrl}${u}` : u;

const data = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  itemListElement: items.map((it, idx) => ({
    "@type": "ListItem",
    position: idx + 1,
    name: it.name,
    item: normalizeUrl(it.url),
  })),
};
---

<script type="application/ld+json">{JSON.stringify(data)}</script>
