---
export type FeaturedSplitData = {
  href: string;
  kicker?: string;
  title: string;
  excerpt?: string;
  author?: string;
  dateLabel?: string;

  image?: string;
  imageAlt?: string;

  bgImage?: string; // fundo opcional atr√°s do texto
};

const {
  href,
  kicker,
  title,
  excerpt,
  author,
  dateLabel,
  image,
  imageAlt = "",
  bgImage,
} = Astro.props as FeaturedSplitData;

const aria = kicker ? `${kicker}: ${title}` : title;
const styleVars = bgImage ? `--feat-bg-image: url('${bgImage}')` : undefined;
---

<article class="featCard" style={styleVars}>
  <a class="featLink" href={href} aria-label={aria}>
    <header class="featText">
      <div class="featTextInner">
        {kicker && <div class="featKicker">{kicker}</div>}
        <h2 class="featTitle">{title}</h2>
        {excerpt && <p class="featExcerpt">{excerpt}</p>}

        {(author || dateLabel) && (
          <div class="featMeta">
            {author && (
              <span>
                Por <strong>{author}</strong>
              </span>
            )}
            {dateLabel && <span class="featDate">{dateLabel}</span>}
          </div>
        )}
      </div>
    </header>

    {image && (
      <div class="featMedia" aria-hidden="true">
        <img class="featImg" src={image} alt={imageAlt} loading="eager" decoding="async" fetchpriority="high" />
      </div>
    )}
  </a>
</article>

<style>
  .featCard {
    border-radius: 0;
    overflow: hidden;
    background: var(--mag-green, #0f4b46);
    color: var(--mag-green-fg, #f4efe7);
    border: 1px solid rgba(255,255,255,0.10);
    box-shadow: 0 18px 40px rgba(0,0,0,.28);
  }

  .featLink {
    display: grid;
    grid-template-columns: 1fr;
    text-decoration: none;
    color: inherit;
    outline: none;
  }

  .featLink:focus-visible {
    outline: 3px solid var(--color-brand-soft, rgba(180, 130, 255, .9));
    outline-offset: 4px;
  }

  @media (min-width: 900px) {
    .featLink {
      grid-template-columns: 1.1fr 0.9fr;
      min-height: 320px;
    }
  }

  .featText {
    position: relative;
    padding: clamp(22px, 3.2vw, 44px);
  }

  /* bg opcional no texto */
  .featText::before {
    content: "";
    position: absolute;
    inset: 0;
    background-image: var(--feat-bg-image);
    background-size: cover;
    background-position: center;
    opacity: 0;
    pointer-events: none;
  }

  .featText::after {
    content: "";
    position: absolute;
    inset: 0;
    pointer-events: none;
    opacity: 0;
  }

  .featCard[style*="--feat-bg-image"] .featText::before {
    opacity: 0.16;
  }

  .featCard[style*="--feat-bg-image"] .featText::after {
    opacity: 1;
    background: linear-gradient(to right, rgba(15,75,70,0.65), rgba(15,75,70,0.92));
  }

  .featTextInner {
    position: relative;
    z-index: 1;
    max-width: 72ch;
  }

  .featKicker {
    font: 800 0.78rem/1.2 system-ui, -apple-system, Segoe UI, Roboto, Arial;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    opacity: 0.92;
    margin-bottom: 12px;
  }

  .featTitle {
    font-family: "Playfair Display", serif;
    font-size: clamp(1.8rem, 3vw, 2.6rem);
    line-height: 1.02;
    letter-spacing: -0.03em;
    margin: 0 0 14px 0;
  }

  .featExcerpt {
    margin: 0 0 18px 0;
    line-height: 1.7;
    opacity: 0.92;
    max-width: 60ch;
  }

  .featMeta {
    display: flex;
    flex-wrap: wrap;
    gap: 10px 14px;
    opacity: 0.95;
  }

  .featMeta strong {
    font-weight: 900;
  }

  .featMedia {
    background: rgba(255,255,255,0.04);
    aspect-ratio: 16 / 10;
  }

  @media (min-width: 900px) {
    .featMedia { aspect-ratio: auto; }
  }

  .featImg {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }
</style>