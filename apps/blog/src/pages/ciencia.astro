---
import BaseLayout from "../layouts/BaseLayout.astro";
import MagCard from "../components/editorial/MagCard.astro";

const title = "Ciência | VivaTDAH";
const description =
  "Ciência do TDAH em linguagem humana: funções executivas, motivação, dopamina, tempo subjetivo, comorbidades e evidências do que ajuda.";

const canonical = Astro.site ? new URL(`/ciencia`, Astro.site).toString() : `/ciencia`;
const ogImage = "/hero/TDAH_sintomas.png";

/* ====== Conteúdo (o que você já tinha) ====== */
const clusters = [
  { title: "Funções executivas", description: "Inibição, memória de trabalho, flexibilidade e planejamento.", href: "/post/funcoes-executivas" },
  { title: "Motivação e dopamina", description: "Tônica, fásica, novidade, recompensa e esforço.", href: "/post/dopamina-motivacao" },
  { title: "Tempo subjetivo", description: "Por que o tempo some e como isso impacta prazos.", href: "/post/tempo-subjetivo" },
  { title: "Comorbidades e diferencial", description: "O que confunde e como ler sintomas com cuidado.", href: "/post/comorbidades" },
  { title: "Tratamentos com evidência", description: "O que costuma funcionar e para quem.", href: "/post/tratamento-evidencias" },
  { title: "Máscara e custo psicológico", description: "Camuflagem social, burnout e sofrimento invisível.", href: "/post/mascara-social" },
];

const curated = [
  { title: "Funções executivas: o centro do TDAH", excerpt: "Entender o mecanismo muda a estratégia.", href: "/post/funcoes-executivas" },
  { title: "Motivação funcional e dopamina", excerpt: "Por que motivação não é constante e como construir tração.", href: "/post/dopamina-motivacao" },
  { title: "Tempo subjetivo no TDAH", excerpt: "Planejar sem entender isso vira autoengano.", href: "/post/tempo-subjetivo" },
];

const faq = [
  { q: "Ciência aqui é só paper?", a: "Não. É evidência traduzida. A ideia é virar decisão prática, não acumular informação." },
  { q: "Por que eu entendo tudo e mesmo assim travo?", a: "Porque compreensão não liga motor. O motor depende de energia, emoção, contexto e apoio externo. Isso é biomecânica do comportamento." },
  { q: "O que eu faço com essa parte científica?", a: "Use para calibrar expectativas, escolher estratégias mais compatíveis e parar de se culpar por fenômenos neurobiológicos reais." },
];

/* ====== Layout estilo “revista roxinho” ====== */
const hero = {
  kicker: "SEÇÃO",
  title: "Ciência",
  subtitle:
    "Ciência em linguagem humana. O suficiente para entender o mecanismo e escolher o próximo passo com clareza, sem virar biblioteca ambulante.",
  image: "/hero/TDAH_sintomas.png",
  alt: "Ciência do TDAH em linguagem humana",
};

const quickRoutes = [
  { title: "Funções executivas", desc: "O centro do TDAH: inibição, memória de trabalho e planejamento.", href: "/post/funcoes-executivas" },
  { title: "Dopamina e motivação", desc: "Motivação não é constante. Entenda tônica, fásica e tração.", href: "/post/dopamina-motivacao" },
  { title: "Tempo subjetivo", desc: "Por que o tempo some e como isso derruba prazos e promessas.", href: "/post/tempo-subjetivo" },
];

const steps = [
  { title: "1) Use ciência para calibrar expectativa", text: "Quando você entende o mecanismo, para de se medir por régua errada." },
  { title: "2) Transforme mecanismo em decisão", text: "Cada conceito aqui deve virar um ajuste em estratégia, ambiente ou suporte." },
  { title: "3) Evite o erro clássico", text: "Ciência sem plano vira cobrança e mais uma pilha de “eu já sei”." },
  { title: "4) Complete o triângulo", text: "Ciência (entender) + Regulação (base) + Estratégias (execução)." },
];

/* ====== Featured (1 grande + 3) ====== */
const featuredCardImages = [
  "/hero/TDAH_sintomas.png",
  "/hero/Diagnostico.jpg",
  "/hero/tdah.jpg",
  "/hero/comece-aqui.jpg",
];

const featuredHero = {
  href: curated?.[0]?.href ?? "/post/funcoes-executivas",
  kicker: "ARREDONDAMENTO",
  title: curated?.[0]?.title ?? "Funções executivas: o centro do TDAH",
  excerpt: curated?.[0]?.excerpt ?? "Entender o mecanismo muda a estratégia.",
  image: featuredCardImages[0],
  imageAlt: "Imagem de capa",
};

const featuredCards = [
  {
    href: curated?.[1]?.href ?? "/post/dopamina-motivacao",
    kicker: "ARREDONDAMENTO",
    title: curated?.[1]?.title ?? "Motivação funcional e dopamina",
    excerpt: curated?.[1]?.excerpt ?? "Por que motivação não é constante e como construir tração.",
    image: featuredCardImages[1],
    imageAlt: "Imagem dopamina",
    variant: "green",
  },
  {
    href: curated?.[2]?.href ?? "/post/tempo-subjetivo",
    kicker: "ARREDONDAMENTO",
    title: curated?.[2]?.title ?? "Tempo subjetivo no TDAH",
    excerpt: curated?.[2]?.excerpt ?? "Planejar sem entender isso vira autoengano.",
    image: featuredCardImages[2],
    imageAlt: "Imagem tempo subjetivo",
    variant: "green",
  },
  {
    href: "/regulacao",
    kicker: "APLICAÇÃO",
    title: "Levar isso para o corpo",
    excerpt: "Regulação estabiliza o motor. Ciência vira plano quando vira rotina mínima.",
    image: featuredCardImages[3],
    imageAlt: "Imagem aplicação",
    variant: "green",
  },
];

const cta = {
  title: "Quer transformar isso em plano?",
  text: "Se sua dificuldade é execução, vá para Estratégias e Regulação. Ciência sem plano vira cobrança.",
  primaryHref: "/estrategias",
  primaryLabel: "Ir para Estratégias",
  secondaryHref: "/regulacao",
  secondaryLabel: "Ir para Regulação",
};
---

<BaseLayout
  title={title}
  description={description}
  canonical={canonical}
  ogImage={ogImage}
  ogType="website"
>
  <style>
    /* ===========================
       PADRÃO (mesmo do index)
       =========================== */
    :root {
      --hover-ring: rgba(170, 140, 255, 0.92);

      --card-radius-std: 22px;
      --card-bg-std: rgba(45, 27, 78, 0.92);
      --card-bg-std-hover: rgba(55, 30, 95, 0.92);
      --card-border-std: rgba(170, 140, 255, 0.22);
      --card-border-std-hover: rgba(170, 140, 255, 0.62);

      --card-text-std: rgba(246, 243, 255, 0.92);
      --card-muted-std: rgba(246, 243, 255, 0.78);
    }

    .wrap {
      max-width: 1100px;
      margin: 0 auto;
      padding: clamp(18px, 4vw, 56px) 16px;
      display: grid;
      gap: clamp(18px, 3vw, 34px);
    }

    .sectionTitle {
      font-family: "Playfair Display", serif;
      font-size: clamp(1.55rem, 2.3vw, 2.25rem);
      line-height: 1.12;
      letter-spacing: -0.02em;
      margin: 0 0 14px 0;
      position: relative;
    }
    .sectionTitle::after {
      content: "";
      display: block;
      width: 72px;
      height: 2px;
      margin-top: 12px;
      background: rgba(170, 140, 255, 0.65);
    }

    .card {
      background: rgba(45, 27, 78, 0.35);
      border: 1px solid var(--card-border-std);
      border-radius: var(--card-radius-std);
      padding: clamp(16px, 3vw, 34px);
      box-shadow: 0 14px 34px rgba(0, 0, 0, 0.18);
    }

    .muted {
      color: var(--card-muted-std);
    }

    /* HERO */
    .hero {
      border-radius: var(--card-radius-std);
      overflow: hidden;
      border: 1px solid var(--card-border-std);
      background: var(--card-bg-std);
      box-shadow: 0 18px 44px rgba(0, 0, 0, 0.22);
      display: grid;
      grid-template-columns: 1fr;
    }
    @media (min-width: 980px) {
      .hero {
        grid-template-columns: 1.08fr 0.92fr;
        min-height: 380px;
      }
    }

    .heroText {
      padding: clamp(18px, 3vw, 34px);
      display: grid;
      gap: 12px;
      align-content: start;
      min-width: 0;
    }

    .kicker {
      font-weight: 750;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      font-size: 0.78rem;
      opacity: 0.92;
      color: var(--card-text-std);
    }

    .heroTitle {
      font-family: "Playfair Display", serif;
      font-size: clamp(2rem, 3.4vw, 3.1rem);
      line-height: 1.04;
      margin: 0;
      color: #fff;
    }

    .heroSubtitle {
      margin: 0;
      line-height: 1.65;
      color: rgba(246, 243, 255, 0.84);
      max-width: 62ch;
    }

    .heroActions {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      margin-top: 10px;
      align-items: stretch;
    }
    .heroActions a { text-decoration: none; }

    /* ✅ FIX (definitivo): evita sobreposição/desnível em qualquer largura intermediária */
    .heroActions :global(.ds-btn) {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      box-sizing: border-box;
      margin: 0;
      min-height: 44px;
      flex: 1 1 220px; /* quebra bonito antes de apertar demais */
      min-width: 0;
    }
    @media (max-width: 520px) {
      .heroActions {
        flex-direction: column;
        width: 100%;
      }
      .heroActions :global(.ds-btn) {
        width: 100%;
        flex: 0 0 auto;
      }
    }
    @media (min-width: 980px) {
      .heroActions :global(.ds-btn) {
        flex: 0 0 auto;
        width: auto;
      }
    }

    .heroMedia {
      position: relative;
      min-height: 240px;
      background: rgba(0, 0, 0, 0.12);
    }
    .heroMedia img {
      width: 100%;
      height: 100%;
      display: block;
      object-fit: cover;
      object-position: center;
    }

    /* Rotas rápidas */
    .grid3 {
      display: grid;
      gap: 16px;
      grid-template-columns: 1fr;
      align-items: stretch;
    }
    @media (min-width: 780px) {
      .grid3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
    }
    .grid3 > * { height: 100%; }

    .routeCard {
      background: var(--card-bg-std);
      border: 1px solid var(--card-border-std);
      border-radius: var(--card-radius-std);
      padding: 18px;
      display: grid;
      gap: 10px;
      height: 100%;
      box-shadow: 0 14px 30px rgba(0, 0, 0, 0.18);
      text-decoration: none;
      color: inherit;
      min-width: 0;
    }

    .routeTitle {
      font-family: "Playfair Display", serif;
      font-size: 1.35rem;
      margin: 0;
      color: #fff;
      line-height: 1.12;
      letter-spacing: -0.01em;
    }

    /* Clusters */
    .clustersGrid {
      display: grid;
      gap: 16px;
      grid-template-columns: 1fr;
      align-items: stretch;
    }
    @media (min-width: 720px) {
      .clustersGrid { grid-template-columns: repeat(2, minmax(0, 1fr)); }
    }
    @media (min-width: 1024px) {
      .clustersGrid { grid-template-columns: repeat(3, minmax(0, 1fr)); }
    }
    .clustersGrid > * { height: 100%; }

    .clusterCard {
      background: var(--card-bg-std);
      border: 1px solid var(--card-border-std);
      border-radius: var(--card-radius-std);
      padding: 16px 18px 20px;
      text-decoration: none;
      color: inherit;
      display: grid;
      gap: 10px;
      height: 100%;
      box-shadow: 0 14px 30px rgba(0, 0, 0, 0.18);
      min-width: 0;
    }

    .clusterTitle {
      font-family: "Playfair Display", serif;
      margin: 0;
      font-weight: 700;
      color: #fff;
      line-height: 1.12;
      letter-spacing: -0.01em;
    }

    /* Steps */
    .steps { display: grid; gap: 12px; }
    .stepRow {
      display: grid;
      gap: 6px;
      padding: 14px 0;
      border-bottom: 1px solid rgba(170, 140, 255, 0.18);
    }
    .stepRow:last-child { border-bottom: none; }
    .stepTitle { margin: 0; font-weight: 760; color: #fff; }
    .stepText {
      margin: 0;
      color: var(--card-muted-std);
      line-height: 1.6;
      max-width: 72ch;
    }

    /* Featured */
    .featuredWrap { display: grid; gap: 18px; }

    .featuredBig {
      border-radius: var(--card-radius-std);
      overflow: hidden;
      border: 1px solid var(--card-border-std);
      background: var(--card-bg-std);
      box-shadow: 0 14px 34px rgba(0, 0, 0, 0.22);
    }

    /* ✅ mesmo modelo: imagem em cima + corpo embaixo */
    .featuredBig a {
      display: grid;
      grid-template-columns: 1fr;
      color: inherit;
      text-decoration: none;
    }

    .featuredBigMedia {
      order: -1;
      position: relative;
      min-height: 220px;
      background: rgba(0, 0, 0, 0.08);
    }
    .featuredBigMedia img {
      width: 100%;
      height: 100%;
      display: block;
      object-fit: cover;
      object-position: center;
      transition: transform 0.18s ease;
      transform-origin: center;
    }

    .featuredBigText {
      padding: 16px 18px 20px;
      display: grid;
      gap: 10px;
      align-content: start;
      min-width: 0;
    }

    .featuredBigTitle {
      font-family: "Playfair Display", serif;
      font-size: clamp(1.55rem, 2.2vw, 2.05rem);
      line-height: 1.12;
      margin: 0;
      color: #fff;
      letter-spacing: -0.01em;
    }

    .featuredBigExcerpt {
      margin: 0;
      line-height: 1.6;
      color: var(--card-muted-std);
      max-width: 62ch;
    }

    .magGrid3 {
      display: grid;
      gap: 18px;
      grid-template-columns: 1fr;
      align-items: stretch;
    }
    @media (min-width: 780px) {
      .magGrid3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
    }

    .featuredWrap :global(a) { text-decoration: none; color: inherit; }

    .featuredWrap :global(.magCard img) {
      width: 100%;
      height: 210px;
      object-fit: cover;
      object-position: center;
      display: block;
      transition: transform 0.18s ease;
      transform-origin: center;
    }

    .featuredWrap :global(.magCard--green) {
      background: var(--card-bg-std) !important;
      border: 1px solid var(--card-border-std) !important;
      color: #f6f3ff !important;
      border-radius: var(--card-radius-std) !important;
      overflow: hidden !important;
      height: 100%;
      padding: 0 !important;
      box-shadow: 0 14px 34px rgba(0, 0, 0, 0.18);
    }

    .featuredWrap :global(.magCard--green > div) {
      padding: 16px 18px 20px !important;
      min-width: 0;
    }

    .featuredWrap :global(.magCard--green .ds-muted) {
      color: var(--card-muted-std) !important;
      opacity: 1 !important;
      margin-top: 10px !important;
    }

    /* CTA */
    .cta {
      background: rgba(45, 27, 78, 0.35);
      border: 1px solid var(--card-border-std);
      display: grid;
      gap: 14px;
      align-items: center;
      text-align: left;
      border-radius: var(--card-radius-std);
    }

    .ctaActions {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      margin-top: 6px;
      align-items: stretch;
    }
    .ctaActions a { text-decoration: none; }

    /* ✅ FIX (definitivo): evita sobreposição/desnível no CTA também */
    .ctaActions :global(.ds-btn) {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      box-sizing: border-box;
      margin: 0;
      min-height: 44px;
      flex: 1 1 220px;
      min-width: 0;
    }
    @media (max-width: 520px) {
      .ctaActions {
        flex-direction: column;
        width: 100%;
      }
      .ctaActions :global(.ds-btn) {
        width: 100%;
        flex: 0 0 auto;
      }
    }
    @media (min-width: 900px) {
      .cta { grid-template-columns: 1.3fr 0.7fr; }
      .ctaActions { justify-content: flex-end; }
      .ctaActions :global(.ds-btn) {
        flex: 0 0 auto;
        width: auto;
      }
    }

    /* FAQ */
    .faqItem {
      border-bottom: 1px solid rgba(170, 140, 255, 0.18);
      padding: 14px 0;
    }
    .faqItem summary {
      cursor: pointer;
      font-weight: 700;
      list-style: none;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }
    .faqItem summary::-webkit-details-marker { display: none; }

    /* =========================================
       HOVER + CONTORNO (ring) + ZOOM
       ========================================= */
    :global(.ds-btn),
    .routeCard,
    .clusterCard,
    .featuredBig,
    .featuredBig a,
    .featuredWrap :global(.magCard--green) {
      transition: transform 0.18s ease, box-shadow 0.18s ease, border-color 0.18s ease,
        filter 0.18s ease, background 0.18s ease, color 0.18s ease;
      will-change: transform;
    }

    :global(.ds-btn:hover) {
      transform: translateY(-1px);
      filter: brightness(1.06) saturate(1.06);
      box-shadow: 0 12px 26px rgba(0, 0, 0, 0.22), 0 0 0 2px var(--hover-ring);
    }
    :global(.ds-btn:active) {
      transform: translateY(0px);
      filter: brightness(0.98);
    }

    :global(.ds-btn-outline:hover),
    :global(.ds-btn--outline:hover) {
      background: rgba(170, 140, 255, 0.14);
      border-color: rgba(170, 140, 255, 0.55);
    }
    :global(.ds-btn-primary:hover),
    :global(.ds-btn--primary:hover) {
      box-shadow: 0 14px 30px rgba(170, 140, 255, 0.22), 0 12px 26px rgba(0, 0, 0, 0.22),
        0 0 0 2px var(--hover-ring);
      filter: brightness(1.05) saturate(1.05);
    }

    .routeCard:hover,
    .clusterCard:hover,
    .featuredBig:hover,
    .featuredWrap :global(.magCard--green:hover) {
      transform: translateY(-3px);
      border-color: var(--card-border-std-hover);
      background: var(--card-bg-std-hover);
      box-shadow: 0 18px 44px rgba(0, 0, 0, 0.28), 0 10px 30px rgba(170, 140, 255, 0.12),
        0 0 0 2px var(--hover-ring);
    }

    .featuredBig:hover .featuredBigMedia img,
    .featuredWrap :global(.magCard--green:hover img) {
      transform: scale(1.02);
    }

    :global(.ds-btn:focus-visible),
    .routeCard:focus-visible,
    .clusterCard:focus-visible,
    .featuredBig a:focus-visible,
    .featuredWrap :global(.magCard--green a:focus-visible),
    .ctaActions a:focus-visible {
      outline: 2px solid rgba(170, 140, 255, 0.75);
      outline-offset: 4px;
      border-radius: 14px;
    }

    @media (prefers-reduced-motion: reduce) {
      :global(.ds-btn),
      .routeCard,
      .clusterCard,
      .featuredBig,
      .featuredBig a,
      .featuredWrap :global(.magCard--green),
      .featuredBigMedia img,
      .featuredWrap :global(.magCard img) {
        transition: none !important;
        transform: none !important;
      }
    }
  </style>

  <!-- HERO -->
  <section class="wrap" style="padding-top: 22px;">
    <header class="hero">
      <div class="heroText">
        <div class="kicker">{hero.kicker}</div>
        <h1 class="heroTitle">{hero.title}</h1>
        <p class="heroSubtitle">{hero.subtitle}</p>

        <div class="heroActions">
          <a class="ds-btn ds-btn-primary" href="/estrategias">Ir para Estratégias</a>
          <a class="ds-btn ds-btn-outline" href="/regulacao">Ir para Regulação</a>
        </div>
      </div>

      <div class="heroMedia">
        <img src={hero.image} alt={hero.alt} loading="eager" decoding="async" />
      </div>
    </header>
  </section>

  <main class="wrap">
    <!-- Rotas rápidas -->
    <section class="card">
      <h2 class="sectionTitle">Rotas rápidas</h2>
      <div class="grid3">
        {quickRoutes.map((r) => (
          <a class="routeCard" href={r.href}>
            <h3 class="routeTitle">{r.title}</h3>
            <p class="muted" style="margin:0; line-height:1.55;">{r.desc}</p>
          </a>
        ))}
      </div>
    </section>

    <!-- Clusters -->
    <section class="card">
      <h2 class="sectionTitle">Clusters principais</h2>
      <div class="clustersGrid">
        {clusters.map((c) => (
          <a class="clusterCard" href={c.href}>
            <h3 class="clusterTitle">{c.title}</h3>
            <p class="muted" style="margin:0; line-height:1.55;">{c.description}</p>
          </a>
        ))}
      </div>
    </section>

    <!-- Como usar ciência -->
    <section class="card">
      <h2 class="sectionTitle">Como usar ciência sem se perder</h2>
      <div class="steps">
        {steps.map((s) => (
          <div class="stepRow">
            <h3 class="stepTitle">{s.title}</h3>
            <p class="stepText">{s.text}</p>
          </div>
        ))}
      </div>
    </section>

    <!-- Artigos de destaque -->
    <section>
      <h2 class="sectionTitle">Artigos de destaque</h2>

      <div class="featuredWrap">
        <article class="featuredBig">
          <a href={featuredHero.href}>
            <div class="featuredBigText">
              <div class="kicker">{featuredHero.kicker}</div>
              <h3 class="featuredBigTitle">{featuredHero.title}</h3>
              <p class="featuredBigExcerpt">{featuredHero.excerpt}</p>
            </div>

            <div class="featuredBigMedia">
              <img
                src={featuredHero.image}
                alt={featuredHero.imageAlt}
                loading="lazy"
                decoding="async"
              />
            </div>
          </a>
        </article>

        <div class="magGrid3">
          {featuredCards.map((c) => (
            <MagCard {...c} />
          ))}
        </div>
      </div>
    </section>

    <!-- CTA -->
    <section class="card cta">
      <div>
        <h2 style="margin:0 0 8px 0; font-family:'Playfair Display',serif; color:#fff;">
          {cta.title}
        </h2>
        <p class="muted" style="margin:0; line-height:1.7;">
          {cta.text}
        </p>
      </div>

      <div class="ctaActions">
        <a class="ds-btn ds-btn-primary" href={cta.primaryHref}>{cta.primaryLabel}</a>
        <a class="ds-btn ds-btn-outline" href={cta.secondaryHref}>{cta.secondaryLabel}</a>
      </div>
    </section>

    <!-- FAQ -->
    <section class="card">
      <h2 class="sectionTitle">FAQ</h2>
      {faq.map((item, idx) => (
        <details class="faqItem" open={idx === 0}>
          <summary>
            <span>{item.q}</span>
            <span aria-hidden="true" style="opacity:.8;">›</span>
          </summary>
          <p class="muted" style="margin:10px 0 0 0; line-height:1.7; max-width:72ch;">
            {item.a}
          </p>
        </details>
      ))}
    </section>
  </main>
</BaseLayout>